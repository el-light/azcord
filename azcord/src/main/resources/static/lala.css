:root{
    --bg-primary:#36393f;--bg-secondary:#2f3136;--bg-tertiary:#202225;--bg-input:#40444b;
    --text-primary:#dcddde;--text-muted:#b9bbbe;--text-link:#00a8fc;
    --accent:#5865f2;--danger:#ed4245;--success:#43b581;
    --interactive-normal:#b9bbbe;--interactive-hover:#dcddde;--interactive-active:#ffffff;
    --bg-modifier-hover:rgba(79,84,92,.16);--bg-modifier-active:rgba(79,84,92,.24);
    --bg-modifier-selected:rgba(79,84,92,.08)
}
body{font-family:'Inter',sans-serif;background-color:var(--bg-primary);color:var(--text-primary)}
::-webkit-scrollbar{width:8px;height:8px}
::-webkit-scrollbar-thumb{background:var(--bg-tertiary);border-radius:4px}
::-webkit-scrollbar-track{background:var(--bg-secondary)}
.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
.server-icon{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:18px;color:#fff;background-color:var(--bg-secondary);cursor:pointer;transition:all .15s ease-out;overflow:hidden;flex-shrink:0}.server-icon:hover{border-radius:16px;background-color:var(--accent)}.server-icon img{width:100%;height:100%;object-fit:cover}.server-icon.active{border-radius:16px;background-color:var(--accent);box-shadow:0 0 0 2px var(--bg-primary),0 0 0 4px var(--accent)}.server-icon.user-avatar-icon{margin-top:auto}.server-icon.user-avatar-icon:hover{background-color:var(--bg-input)}
.list-header{padding:12px 8px 4px 16px;font-size:12px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:.025em}
.channel-item{padding:6px 10px;margin:1px 8px;border-radius:4px;font-size:15px;cursor:pointer;user-select:none;color:var(--text-muted);display:flex;align-items:center;gap:8px}.channel-item:hover{background-color:var(--bg-modifier-hover);color:var(--interactive-hover)}.channel-item.active{background-color:var(--bg-modifier-active);color:var(--interactive-active);font-weight:500}.channel-item .icon{color:var(--text-muted);font-size:18px}.channel-item.active .icon{color:var(--interactive-active)}.channel-item .avatar{width:24px;height:24px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:12px;color:#fff}
.message-group{display:flex;gap:16px;padding:8px 16px 2px 16px;position:relative;margin-top:12px}.message-group:hover{background-color:var(--bg-modifier-selected)}.message-group .avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;cursor:pointer;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#fff}.message-body{flex-grow:1;padding-top:2px}.message-header{display:flex;align-items:baseline;gap:8px;font-size:14px;margin-bottom:2px}.message-header .name{font-weight:500;color:var(--text-primary);cursor:pointer}.message-header .name:hover{text-decoration:underline}.message-header .timestamp{font-size:12px;color:var(--text-muted)}.message-content{white-space:pre-wrap;font-size:15px;line-height:1.375rem;color:var(--text-primary);word-wrap:break-word}.message-content a{color:var(--text-link);text-decoration:underline}.message-content img.attachment-preview{max-width:320px;max-height:280px;border-radius:6px;cursor:pointer;margin-top:6px;display:block}.message-content .file-attachment{display:inline-flex;align-items:center;gap:6px;background-color:var(--bg-secondary);padding:8px 12px;border-radius:4px;margin-top:6px;color:var(--text-link);text-decoration:none;font-size:14px;border:1px solid var(--bg-tertiary)}.message-content .file-attachment:hover{border-color:var(--text-link)}
.replied-to-message{background-color:rgba(255,255,255,.03);padding:4px 8px;border-radius:4px;margin-bottom:4px;font-size:.8rem;color:var(--text-muted);border-left:2px solid var(--accent);cursor:pointer}.replied-to-message:hover{background-color:rgba(255,255,255,.05)}.replied-to-message strong{color:var(--interactive-hover)}
.reaction-bar{display:flex;gap:4px;margin-top:6px;flex-wrap:wrap}.reaction-pill{display:flex;gap:4px;align-items:center;padding:3px 7px;border-radius:16px;font-size:13px;background-color:var(--bg-input);cursor:pointer;color:var(--text-muted);user-select:none;border:1px solid transparent;transition:background-color .1s}.reaction-pill:hover{background-color:var(--bg-modifier-hover);border-color:var(--accent)}.reaction-pill.reacted-by-user{background-color:rgba(88,101,242,.2);border-color:var(--accent);color:var(--accent)}.reaction-pill .count{font-size:.8em;margin-left:2px}.add-reaction-btn{font-size:12px;padding:3px 5px!important;background-color:var(--bg-input)!important}
.message-group .hover-actions{position:absolute;right:16px;top:-14px;opacity:0;display:flex;gap:4px;transition:opacity .1s ease-out;background-color:var(--bg-secondary);border:1px solid var(--bg-tertiary);border-radius:6px;padding:4px;box-shadow:0 2px 4px rgba(0,0,0,.2);z-index:10}.message-group:hover .hover-actions{opacity:1}.action-btn{width:28px;height:28px;border-radius:4px;display:flex;align-items:center;justify-content:center;color:var(--interactive-normal);background-color:transparent;font-size:18px;cursor:pointer}.action-btn:hover{color:var(--interactive-hover);background-color:var(--bg-modifier-hover)}
.upload-thumbnail{width:64px;height:64px;background-color:var(--bg-input);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:12px;position:relative;overflow:hidden;border:1px dashed var(--text-muted)}.upload-thumbnail img{width:100%;height:100%;object-fit:cover}.upload-thumbnail .remove-upload{position:absolute;top:-8px;right:-8px;width:20px;height:20px;border-radius:50%;background-color:var(--danger);color:#fff;font-size:14px;display:flex;align-items:center;justify-content:center;cursor:pointer;border:2px solid var(--bg-secondary)}
.toast-notification{position:fixed;bottom:20px;right:20px;background-color:var(--bg-tertiary);color:var(--text-primary);padding:12px 18px;border-radius:6px;opacity:0;animation:toastFadeInOut 4s forwards;box-shadow:0 4px 12px rgba(0,0,0,.3);z-index:1000}@keyframes toastFadeInOut{0%,100%{opacity:0;transform:translateY(10px)}10%,90%{opacity:1;transform:translateY(0)}}
#profileModalContainer{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background-color:rgba(0,0,0,.7);z-index:50}#profileModalContainer.show{display:flex}.profile-card{background-color:var(--bg-secondary);padding:24px;border-radius:8px;width:100%;max-width:400px;display:flex;flex-direction:column;gap:16px}.profile-card .avatar-container{display:flex;flex-direction:column;align-items:center;gap:8px}.profile-card .profile-avatar-display{width:100px;height:100px;border-radius:50%;object-fit:cover;background-color:var(--accent);display:flex;align-items:center;justify-content:center;font-size:48px;color:#fff;cursor:pointer;border:3px solid var(--bg-tertiary)}.profile-card input[type=text],.profile-card textarea{background-color:var(--bg-input);padding:10px 12px;border-radius:4px;color:var(--text-primary);width:100%;border:1px solid var(--bg-tertiary)}.profile-card textarea{min-height:80px;resize:vertical}.profile-card .form-actions{display:flex;justify-content:flex-end;gap:8px}.profile-card .form-actions button{padding:8px 16px;border-radius:4px;font-weight:500}.profile-card .form-actions .save-btn{background-color:var(--accent);color:#fff}.profile-card .form-actions .cancel-btn{background-color:transparent;color:var(--text-muted);border:1px solid var(--text-muted)}
.emoji-picker{position:absolute;background-color:var(--bg-secondary);border:1px solid var(--bg-tertiary);border-radius:8px;padding:8px;display:flex;flex-wrap:wrap;gap:6px;box-shadow:0 4px 12px rgba(0,0,0,.3);z-index:20;width:auto;max-width:200px}.emoji-picker span{font-size:20px;cursor:pointer;padding:4px;border-radius:4px}.emoji-picker span:hover{background-color:var(--bg-modifier-hover)}
.avatar-box{position:fixed;inset:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:100}.avatar-box img{max-width:80vw;max-height:80vh;border-radius:8px}
.profile-pop{position:fixed;z-index:90;background:var(--bg-secondary);padding:16px;border-radius:8px;width:240px}.profile-pop img{width:64px;height:64px;border-radius:50%;cursor:pointer}.profile-pop h4{font-size:16px;font-weight:700;margin-top:6px}.profile-pop p{font-size:13px;color:#b9bbbe;margin-top:2px}
.friends{box-shadow:-2px 0 5px rgba(0,0,0,.2)}.dm-row{display:flex;align-items:center;gap:10px;padding:8px;border-radius:4px;margin-bottom:4px;transition:background-color .2s}.dm-row:hover{background-color:var(--bg-modifier-hover)}.dm-row img.avatar{width:32px;height:32px;border-radius:50%;object-fit:cover}.dm-row span{flex-grow:1;color:var(--text-primary);font-size:14px}.dm-row button{font-size:12px;padding:4px 8px;border-radius:4px}.dm-row button.btn{background-color:var(--accent);color:#fff}.dm-row button.secondary{background-color:transparent;border:1px solid var(--text-muted);color:var(--text-muted)}.typing-indicator{font-size:12px;color:#b9bbbe;padding-left:16px;padding-top:2px}

/* Core palette / layout variables assumed to exist elsewhere */

/* ═══════════════  COMMON UTILITIES  ═══════════════ */
.no-scrollbar::-webkit-scrollbar { display: none; }
.server-icon      { @apply w-12 h-12 rounded-full bg-[var(--bg-input)] text-white flex items-center justify-center cursor-pointer hover:bg-[var(--bg-modifier-hover)]; }
.channel-item     { @apply flex items-center gap-2 px-2 py-1 rounded-md cursor-pointer text-[var(--text-primary)] hover:bg-[var(--bg-modifier-hover)]; }
.channel-item.active { background: var(--bg-modifier-selected); }
.list-header      { @apply px-2 py-1 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wide; }
.dm-row           { @apply flex items-center gap-2 px-2 py-1 rounded-md; }
.avatar           { @apply w-8 h-8 rounded-full overflow-hidden flex-shrink-0 bg-[var(--bg-input)] text-white text-sm font-semibold flex items-center justify-center; }

.toast-notification { /* This will override or merge with the existing .toast-notification rule */
  position: fixed; bottom: 20px; right: 20px; z-index: 1000;
  padding: .5rem 1rem; border-radius: .375rem; color: #fff;
  background: var(--accent); animation: toastFade 3s forwards;
}
@keyframes toastFade { /* This will be a new animation, the old toastFadeInOut will still exist but .toast-notification will now use this one */
    0%{opacity:1} 
    90%{opacity:1} 
    100%{opacity:0} 
}

/* ═══════════════  MODALS / SLIDE-OUTS  ═══════════════ */
#serverSettingsModal>div,
#channelSettingsModal>div,
#roleMgmtModal>div {
  max-height: 90vh;
  overflow-y: auto;
}

#memberPanel {
  transform: translateX(100%);
  transition: transform .25s ease;
}
#memberPanel.show { transform: translateX(0); }

/* any other bespoke tweaks … */